
<section>
    <h2 class="text-center text-main">Forgot Password</h2>
    @if (step === 1) {
        <form [formGroup]="verifyEmail" class="bg-main-light py-3 my-2 shadow rounded-4" (ngSubmit)="emailSubmit()">
            <div class="my-2">
                <label for="email">email</label>
                <input formControlName="email" type="email" id="email" class="form-control">
                @if (verifyEmail.get('email')?.errors && (verifyEmail.get('email')?.touched || verifyEmail.get('email')?.dirty)) {
                    <div class="w-50 alert alert-danger">
                        @if (verifyEmail.get('email')?.getError('required')) {
                            <p class="m-0">email is required</p>
                        }
                        @else if (verifyEmail.get('email')?.getError('email')) {
                            <p class="m-0">invalid email</p>
                        }
                    </div>
                }
            </div>
            <button [disabled]="isLoading" class="btn-main">
                verify mail
                @if (isLoading) {
                    <span><i class="fas fa-spin fa-spinner"></i></span>
                }
            </button>
            @if (msgSuccess) {
                <p class="text-main fs-4 text-center m-0">{{msgSuccess}}</p>
            }
            @if (msgError) {
                <p class="m-0 w-50 alert alert-danger">{{msgError}}</p>
            }
        </form>
    }
    @else if (step === 2) {
        <form [formGroup]="verifyCode" class="bg-main-light py-3 my-2 shadow rounded-4" (ngSubmit)="codeSubmit()">
            <div class="my-2">
                <label for="resetCode">resetCode</label>
                <input formControlName="resetCode" type="text" id="resetCode" class="form-control">
                
                @if (verifyCode.get('resetCode')?.errors && (verifyCode.get('resetCode')?.touched || verifyCode.get('resetCode')?.dirty)) {
                    <div class="w-50 alert alert-danger">
                        @if (verifyCode.get('resetCode')?.getError('required')) {
                            <p class="m-0">Code is required</p>
                        }
                        @else if (verifyCode.get('resetCode')?.getError('pattern')) {
                            <p class="m-0">invalid code</p>
                        }
                    </div>
                }
            </div>
            <button class="btn-main">verify code</button>
            @if (validCode) {
                <p class="text-main text-center m-0">correct code</p>
            }
        </form>
    }
    @else if (step === 3) {
        <form [formGroup]="resetPassword" class="bg-main-light py-3 my-2 shadow rounded-4" (ngSubmit)="resetPasswordSubmit()">
            <div class="my-2">
                <label for="email">email</label>
                <input formControlName="email" type="email" id="email" class="form-control">
                
                @if (resetPassword.get('email')?.errors && (resetPassword.get('email')?.touched || resetPassword.get('email')?.dirty)) {
                    <div class="w-50 alert alert-danger">
                        @if (resetPassword.get('email')?.getError('required')) {
                            <p class="m-0">email is required</p>
                        }
                        @else if (resetPassword.get('email')?.getError('email')) {
                            <p class="m-0">invalid email</p>
                        }
                    </div>
                }
            </div>
            <div class="my-2">
                <label for="newPassword">newPassword</label>
                <input formControlName="newPassword" type="password" id="newPassword" class="form-control" [type]="inputType?'text':'password'">
                @if (resetPassword.get('newPassword')?.dirty) {
                    <button type="button" id="icon" class="btn" (click)="passwordVisibility()">
                        <i id="size" [class]="inputType? 'fa-solid fa-eye' : 'fa fa-eye-slash'"></i>
                    </button>
                }
                @if (resetPassword.get('newPassword')?.errors && (resetPassword.get('newPassword')?.touched || resetPassword.get('newPassword')?.dirty)) {
                    <div class="w-50 alert alert-danger">
                        @if (resetPassword.get('newPassword')?.getError('required')) {
                            <p class="m-0">password is required</p>
                        }
                        @else if (resetPassword.get('newPassword')?.getError('pattern')) {
                            <p class="m-0">incorrect passowrd</p>
                        }
                    </div>
                }
            </div>
            <button [disabled]="resetPassword.invalid || isLoading" class="btn-main">
                Login
                @if (isLoading) {
                    <i class="fas fa-spin fa-spinner"></i>
                }
            </button>
            @if (welcomeHome) {
                <p class="m-0 text-main text-center">welcome to home</p>
            }
            @if (msgError) {
                <p class="w-50 alert alert-danger m-0">{{msgError}}</p>
            }
        </form>
    }
</section>

